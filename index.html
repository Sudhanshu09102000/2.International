<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Internationals</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
  <style>
    body { background-color: #f8f9fa; }
    .question-box {
  padding: 20px;
  background: #fff;
  border-radius: 10px;
  margin-bottom: 20px;
  box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
  min-height: 300px;         /* Fixed minimum height */
  max-height: 500px;         /* Optional: set max if needed */
  overflow-y: auto;          /* Scroll if question overflows */
}

    .options {
  display: flex;
  flex-wrap: wrap;
  gap: 10px;
  justify-content: space-between;
}

.options label {
  width: 48%;                     /* Half width with gap */
  display: block;
  padding: 10px;
  margin-bottom: 10px;
  border: 1px solid #ccc;
  border-radius: 5px;
  cursor: pointer;
  position: relative;
  font-weight: 500;
  background-color: #f8f9fa;
  min-height: 60px;               /* Optional: make height consistent */
  display: flex;
  align-items: center;
}

    .options input[type="radio"] { position: absolute; opacity: 0; }
    .options label.selected {
      background-color: #d1e7dd; border-color: #0f5132;
    }
    .question-nav .btn {
      width: 40px; height: 40px; margin: 5px; border-radius: 50%;
      font-weight: bold; border: 2px solid transparent;
    }
    .question-nav .current-question { border-color: #000; }
    .answered { background-color: #28a745 !important; color: #fff; }
    .not-answered { background-color: #dc3545 !important; color: #fff; }
    .review { background-color: yellow !important; }
    .review-answered {
      background: linear-gradient(to right, yellow 50%, #28a745 50%) !important;
    }
    #timer {
      position: fixed; bottom: 10px; right: 10px;
      background: #343a40; color: #fff;
      padding: 10px 20px; border-radius: 10px; font-weight: bold;
      z-index: 1000;
    }
  </style>
</head>
<body>

<div id="timer">00:00</div>

<div class="container mt-4">
  <div class="question-box">
    <div id="question-image" class="text-center mb-3"></div>
    <div class="options" id="options"></div>
    <button class="btn btn-primary me-2" id="saveNextBtn">Save & Next</button>
    <button class="btn btn-warning" id="reviewNextBtn">Mark for Review & Next</button>
  </div>

  <div id="review-container" style="display:none;"></div>


  <div class="d-flex flex-wrap question-nav" id="question-nav" style="display: none;"></div>
  <button class="btn btn-danger mt-3" id="submitBtn">Submit Test</button>
</div>

<!-- Score Modal -->
<div class="modal fade" id="scoreModal" tabindex="-1">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Test Summary</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body" id="scoreContent"></div>
      <div class="modal-footer">
        <button class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>
  
  
<!-- Explanation Modal -->
<div class="modal fade" id="explanationModal" tabindex="-1">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Explanation</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body" id="explanationContent"></div>
    </div>
  </div>
</div>


<script src="script.js"></script>

<script>
document.addEventListener('DOMContentLoaded', () => {


  // Create nav
  for (let i = 1; i <= totalQuestions; i++) {
    const btn = document.createElement('button');
    btn.className = 'btn btn-outline-secondary';
    btn.id = 'q' + i;
    btn.innerText = i;
    btn.addEventListener('click', () => loadQuestion(i));
    document.getElementById('question-nav').append(btn);
  }

  // Ask test time
  (function askTime() {
    const mins = parseInt(prompt("Enter test time in minutes:"), 10);
    if (mins > 0) {
      totalSeconds = mins * 60;
      startTimer();
    } else {
      alert("Invalid. Try again.");
      askTime();
    }
  })();

  function startTimer() {
    setInterval(() => {
      if (totalSeconds > 0) {
        totalSeconds--;
        const m = String(Math.floor(totalSeconds / 60)).padStart(2, '0');
        const s = String(totalSeconds % 60).padStart(2, '0');
        document.getElementById('timer').innerText = `${m}:${s}`;
      } else {
        document.getElementById('timer').innerText = "Time's up!";
      }
    }, 1000);
  }

  function loadQuestion(num) {
    currentQuestion = num;
    const q = questions[num];

    document.getElementById('question-image').innerHTML = q.text
  ? `<p class="fs-5"><strong>Q${num}.</strong> ${q.text}</p>`
  : `<div class="mb-2"><strong>Q${num}.</strong></div><img src="${q.image}" alt="Question ${num}" class="img-fluid" style="max-height: 300px;" />`;



    const optionHTML = q.options.map((opt, i) => {
      const val = (i + 1).toString();
      const selected = answers[num]?.selected === val ? 'checked' : '';
      const selectedClass = answers[num]?.selected === val ? 'selected' : '';
      return `
        <label class="${selectedClass}">
          <input type="radio" name="option" value="${val}" ${selected} />
          <span>${opt}</span>
        </label>
      `;
    }).join('');
    document.getElementById('options').innerHTML = optionHTML;

    document.querySelectorAll('.question-nav .btn').forEach(b => b.classList.remove('current-question'));
    document.getElementById('q' + num).classList.add('current-question');

    document.querySelectorAll('.options label').forEach(label => {
  const input = label.querySelector('input[type="radio"]');
  
  label.addEventListener('click', (e) => {
    e.preventDefault(); // prevent immediate selection

    const alreadySelected = input.checked;

    // Clear all selections visually and logically
    document.querySelectorAll('.options label').forEach(l => {
      l.classList.remove('selected');
      l.querySelector('input[type="radio"]').checked = false;
    });

    if (!alreadySelected) {
      input.checked = true;
      label.classList.add('selected');
    } else {
      // If tapped again, clear the answer from memory
      delete answers[currentQuestion]?.selected;
    }
  });
});

  }

  

  function updateNav(num, status) {
    const btn = document.getElementById('q' + num);
    btn.classList.remove('answered', 'not-answered', 'review', 'review-answered');
    btn.classList.add(status);
  }

  function mark(forReview) {
    const input = document.querySelector('input[name="option"]:checked');
    const value = input?.value || null;
    answers[currentQuestion] = { selected: value, review: forReview };

    const status = forReview
      ? (value ? 'review-answered' : 'review')
      : (value ? 'answered' : 'not-answered');

    updateNav(currentQuestion, status);
    if (currentQuestion < totalQuestions) loadQuestion(currentQuestion + 1);
  }

  document.getElementById('saveNextBtn').addEventListener('click', () => mark(false));
  document.getElementById('reviewNextBtn').addEventListener('click', () => mark(true));

  document.getElementById('submitBtn').addEventListener('click', () => {
  let attempted = 0, correct = 0, wrong = 0;
  for (let i = 1; i <= totalQuestions; i++) {
    const sel = answers[i]?.selected;
    if (sel) {
      attempted++;
      if (sel === questions[i]?.correct) correct++;
      else wrong++;
    }
  }
  const skipped = totalQuestions - attempted;
  const score = (correct * 2) - (wrong * 0.5);

  

  // Hide everything except score modal
  document.querySelector('.question-box').style.display = 'none';
  document.getElementById('question-nav').style.display = 'none';
  document.getElementById('submitBtn').style.display = 'none';

  document.getElementById('scoreContent').innerHTML = `
    <p>Attempted: <strong>${attempted}</strong></p>
    <p>Correct: <strong>${correct}</strong> (+2 each)</p>
    <p>Wrong: <strong>${wrong}</strong> (-0.5 each)</p>
    <p>Skipped: <strong>${skipped}</strong></p>
    <p>Score: <strong>${score}</strong></p>
  `;

  // Build review HTML
let reviewHTML = "<h3 class='mb-3'>Question Review</h3>";
for (let i = 1; i <= totalQuestions; i++) {
  const q = questions[i];
  const userAns = answers[i]?.selected || null;
  const correctAns = q.correct;

  // Color class
  let bgClass = '';
  if (userAns) {
    bgClass = (userAns === correctAns) ? 'bg-success text-white' : 'bg-danger text-white';
  } else {
    bgClass = 'bg-secondary text-white'; // skipped
  }

  reviewHTML += `
  <div class="p-3 mb-3 rounded ${bgClass}">
    <p><strong>Q${i}.</strong> ${q.text}</p>
    <p><strong>Your Answer:</strong> ${userAns ? q.options[parseInt(userAns)-1] : 'Not Attempted'}</p>
    <p><strong>Correct Answer:</strong> ${q.options[parseInt(correctAns)-1]}</p>
    ${explanations[i] ? `<button class="btn btn-sm btn-info mt-2" onclick="showExplanation(${i})">View Explanation</button>` : ''}

  </div>
`;

}

// Show review
document.getElementById('review-container').innerHTML = reviewHTML;
document.getElementById('review-container').style.display = 'block';

  new bootstrap.Modal(document.getElementById('scoreModal')).show();
});


  loadQuestion(1);
});
</script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>



